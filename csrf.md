# CSRF에 대해 알아보자

<br />

```
사이트 간 요청 위조의 줄임말.

사용자가 자신의 의지와 무관하게 공격자가 의도한 행동을 해서,
특정 웹페이지를 보안에 취약하게 한다거나 수정, 삭제 등의 작업을 하게 만드는 공격 방법이다.
2008년에 발생한 옥션의 개인정보 유출 사건에서도 관리자 계정을 탈취하는 데 이 방법이 사용되었다.
공격의 난이도가 높지 않아 흔히 사용된다.
```

<br />

예시)
```
만일,
A라는 사이트의 사용자 개인 비밀번호 변경을 하는 주소 패턴이
'http://example.com/user.do?cmd=user_passwd_change&user=admin&newPwd=1234'라고 한다면,
이러한 링크를 사용자의 메일로 보내는데, 만약 사용자가 메일을 읽게 되면 해당 사용자의 패스워드가 1234로 초기화된다.
이를 관리자에게 보내서 일반 계정을 관리자 계정으로 바꾸도록 하거나,
관리자 계정 패스워드를 바꾸는데 이용한다면 해당 사이트의 모든 정보가 해킹당하는 데는 오랜 시간이 걸리지 않는다.

참고로, img 태그도 GET 메소드를 사용해서 보내는 것이기 때문에 img를 이용할 수도 있다.
대부분의 사이트는 img를 필터링하지 않으므로, 혹은 필터링하지 못하므로 유용한 방법이 될 수 있다.
```

<br />

예방 방법)
```
방어 방법 중 가장 기초적인 방법은 Referer 체크를 하는 방법이 있다.
Referer는 HTTP 헤더에 있는 정보로 해당 요청이 요청된 페이지의 정보를 가지고 있는데,
해당 정보는 Paros나 Zap, fiddler같은 프로그램으로 조작이 가능하기 때문에 권장되지 않는다.

그 외에는 패스워드 변경 같은 민감한 정보를 다룰 때에는 세션에 임의난수(토큰)를 발급해서,
해당 난수가 없는 상황에서 해당 동작들이 이루어지면 요청을 거부하는 방법을 통하여
사용자가 정말로 변경을 의도하는 경우에만 변경을 시켜주는 방법,
변경 시에 CAPTCHA를 이용하여 CAPTCHA 인증코드가 없거나 틀리면 거부하도록 하는 방법 등이 이용되고 있다.

또한 GET/POST 등을 구분하여 주는 것 역시 유용하다.
img 태그 등을 이용할 경우 GET 요청으로 들어오게 될 것이고,
반면 흔히 하듯 form을 이용해 값을 받을 경우 POST를 이용하게 되는 경우가 많기 때문이다.

위의 방법들을 일일이 적용하기 귀찮다면,
대개 프레임워크에서 위의 방법들을 통합한 플러그인 등을 제공하는 경우들이 많으니 찾아보도록 하자.
또한 form 대신 ajax를 통한 JSON API만 사용하는 방법이 있다.
만약 굳이 다른 도메인 간 통신을 하고자 한다면, jsonp를 이용하면 된다.
```
```
출처 나무위키 https://namu.wiki/w/CSRF
```
